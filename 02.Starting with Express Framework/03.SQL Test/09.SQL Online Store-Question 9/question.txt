Online Store Database Management

Hey, you are the DB Manager for an online shopping platform. Your job is to manage and maintain the database that tracks all the key information about the storeâ€™s operations. Customers browse products, place orders, and purchase multiple items in a single order. The database stores all the necessary details to manage inventory, calculate total revenue, and track customer activities.




Tables:

Customers Table

Stores customer details like name, email, phone number, address, and registration date.

Structure:CustomerID|Name|Email|PhoneNumber|Address|RegisteredDate




Products Table

Stores product details like product name, category, price, and available stock.

Structure:ProductID|ProductName|Category|Price|Stock




Orders Table

Stores order information such as order date, customer ID, and total amount of the order.

Structure:OrderID|CustomerID|OrderDate|TotalAmount




OrderItems Table

Stores details about each product purchased in the orders, such as product ID, order ID, quantity, and price.

Structure:OrderItemID|OrderID|ProductID|Quantity|Price




Deliverable:

Write an SQL query to retrieve pairs of customers who live at the same address. The result should include the CustomerName and Address for both customers in each pair.

Hint: Use a self join to compare customers with the same address.




Sample Input:

Customers Table:

CustomerID | CustomerName | Address

1 | Alice Johnson | 123 Park Lane, Cityville

2 | Bob Smith | 456 Maple Street, Townsville

3 | Charlie Brown | 123 Park Lane, Cityville

4 | David Williams | 789 Oak Avenue, Hilltop

5 | Eve Roberts | 123 Park Lane, Cityville




Expected Output:

Customer1 | Customer2 | Address

Alice Johnson | Charlie Brown | 123 Park Lane, Cityville

Alice Johnson | Eve Roberts | 123 Park Lane, Cityville

Charlie Brown | Eve Roberts | 123 Park Lane, Cityville
